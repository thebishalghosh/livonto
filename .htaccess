# Enable Rewrite Engine
RewriteEngine On

# Base directory (adjust if your project is in a subdirectory)
RewriteBase /Livonto/

# Handle admin routes first - always route through index.php even if directory exists
RewriteCond %{REQUEST_URI} ^/Livonto/admin/ [NC]
RewriteCond %{REQUEST_URI} !^/Livonto/admin/assets/ [NC]
RewriteCond %{REQUEST_URI} !^/Livonto/admin/.*\.(css|js|jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot)$ [NC]
RewriteRule ^admin/(.*)$ index.php?url=admin/$1 [QSA,L]

# Allow direct access to actual files in app, storage, vendor, sql directories
RewriteCond %{REQUEST_URI} ^/Livonto/(app|storage|vendor|sql)/ [NC]
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Don't rewrite files and directories that exist (this handles CSS, JS, images, etc.)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Don't rewrite assets by extension (backup check)
RewriteCond %{REQUEST_URI} \.(css|js|jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot)$ [NC]
RewriteRule ^ - [L]

# Route all other requests to index.php
RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]

# Remove .php extension from URLs (optional - for direct access)
RewriteCond %{THE_REQUEST} /public/([^?\s]*?)\.php[\s?] [NC]
RewriteRule ^ /%1? [R=301,L]

# Force trailing slash removal (optional)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [R=301,L]

